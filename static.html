<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-3HTENNM8CV"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-3HTENNM8CV');
    </script>
    <link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="spectra: absorption/emission spectrum at zero/finite temperature" href="spectrum.html" /><link rel="prev" title="Low Level Data Structure and Algorithms" href="mps.html" />

    <meta name="generator" content="sphinx-5.3.0, furo 2022.09.29"/>
        <title>Static Eigenstate Method - Renormalizer 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">Renormalizer 0.1.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">Renormalizer 0.1.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation guide</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tutorial.html">Basic Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorials/define_model.html">Define Your Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/mps_mpo.html">MPS and MPO</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/nuclear_basis.html">Nuclear Basis Set</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/quantum_number.html">Quantum Numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/compress_mps.html">Compressing MPS</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/time_evolution.html">Time Evolution using Renormalizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/ttn_basic.html">Basics of Tree Tensor Networks</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="applications.html">Application Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorials/1D-Heisenberg.html">Ground state of the Heisenberg model</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="api.html">API Reference</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="model.html">Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="mps.html">Low Level Data Structure and Algorithms</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Static Eigenstate Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="spectrum.html">spectra: absorption/emission spectrum at zero/finite temperature</a></li>
<li class="toctree-l2"><a class="reference internal" href="ct.html">Charge Transport</a></li>
<li class="toctree-l2"><a class="reference internal" href="cv.html">Frequency domain DMRG</a></li>
<li class="toctree-l2"><a class="reference internal" href="sbm.html">Spin-Boson Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="ttn.html">Tree Tensor Network Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="configs.html">Calculation Configurations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="develop.html">How to develop Renormalizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="cite.html">How to cite</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="static-eigenstate-method">
<h1>Static Eigenstate Method<a class="headerlink" href="#static-eigenstate-method" title="Permalink to this heading">#</a></h1>
<section id="module-renormalizer.mps.gs">
<span id="ground-state-and-state-averaged-method"></span><h2>Ground state and state-averaged method<a class="headerlink" href="#module-renormalizer.mps.gs" title="Permalink to this heading">#</a></h2>
<p>This module contains functions to optimize mps for a single ground state or
several lowest excited states with state-averaged algorithm.</p>
<dl class="py class">
<dt class="sig sig-object py" id="renormalizer.mps.gs.DmrgFCISolver">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">renormalizer.mps.gs.</span></span><span class="sig-name descname"><span class="pre">DmrgFCISolver</span></span><a class="reference internal" href="_modules/renormalizer/mps/gs.html#DmrgFCISolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#renormalizer.mps.gs.DmrgFCISolver" title="Permalink to this definition">#</a></dt>
<dd><p>DMRG interface for PySCF FCI/CASCI/CASSCF</p>
<dl class="py method">
<dt class="sig sig-object py" id="renormalizer.mps.gs.DmrgFCISolver.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/gs.html#DmrgFCISolver.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#renormalizer.mps.gs.DmrgFCISolver.kernel" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="renormalizer.mps.gs.DmrgFCISolver.make_rdm1">
<span class="sig-name descname"><span class="pre">make_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/gs.html#DmrgFCISolver.make_rdm1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#renormalizer.mps.gs.DmrgFCISolver.make_rdm1" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the spin-traced one-body reduced density matrix (1RDM).</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\textrm{1RDM}[p,q] = \langle p_{\alpha}^\dagger q_{\alpha} \rangle
    + \langle p_{\beta}^\dagger q_{\beta} \rangle\]</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rdm1</strong> – The spin-traced one-body RDM.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#renormalizer.mps.gs.DmrgFCISolver.make_rdm2" title="renormalizer.mps.gs.DmrgFCISolver.make_rdm2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_rdm2</span></code></a></dt><dd><p>Evaluate the spin-traced two-body reduced density matrix (2RDM).</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="renormalizer.mps.gs.DmrgFCISolver.make_rdm12">
<span class="sig-name descname"><span class="pre">make_rdm12</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/gs.html#DmrgFCISolver.make_rdm12"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#renormalizer.mps.gs.DmrgFCISolver.make_rdm12" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="renormalizer.mps.gs.DmrgFCISolver.make_rdm2">
<span class="sig-name descname"><span class="pre">make_rdm2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/gs.html#DmrgFCISolver.make_rdm2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#renormalizer.mps.gs.DmrgFCISolver.make_rdm2" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the spin-traced two-body reduced density matrix (2RDM).</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
    \textrm{2RDM}[p,q,r,s] &amp; = \langle p_{\alpha}^\dagger r_{\alpha}^\dagger
    s_{\alpha}  q_{\alpha} \rangle
       + \langle p_{\beta}^\dagger r_{\alpha}^\dagger s_{\alpha}  q_{\beta} \rangle \\
       &amp; \quad + \langle p_{\alpha}^\dagger r_{\beta}^\dagger s_{\beta}  q_{\alpha} \rangle
       + \langle p_{\beta}^\dagger r_{\beta}^\dagger s_{\beta}  q_{\beta} \rangle
\end{aligned}\end{split}\]</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rdm2</strong> – The spin-traced two-body RDM.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#renormalizer.mps.gs.DmrgFCISolver.make_rdm1" title="renormalizer.mps.gs.DmrgFCISolver.make_rdm1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_rdm1</span></code></a></dt><dd><p>Evaluate the spin-traced one-body reduced density matrix (1RDM).</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="renormalizer.mps.gs.DmrgFCISolver.spin_square">
<span class="sig-name descname"><span class="pre">spin_square</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/gs.html#DmrgFCISolver.spin_square"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#renormalizer.mps.gs.DmrgFCISolver.spin_square" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="renormalizer.mps.gs.construct_mps_mpo">
<span class="sig-prename descclassname"><span class="pre">renormalizer.mps.gs.</span></span><span class="sig-name descname"><span class="pre">construct_mps_mpo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nexciton</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset=&lt;renormalizer.utils.quantity.Quantity</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/gs.html#construct_mps_mpo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#renormalizer.mps.gs.construct_mps_mpo" title="Permalink to this definition">#</a></dt>
<dd><p>MPO/MPS structure 2
e1,ph11,ph12,..e2,ph21,ph22,…en,phn1,phn2…</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="renormalizer.mps.gs.eigh_direct">
<span class="sig-prename descclassname"><span class="pre">renormalizer.mps.gs.</span></span><span class="sig-name descname"><span class="pre">eigh_direct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mps.html#renormalizer.mps.Mps" title="renormalizer.mps.mps.Mps"><span class="pre">Mps</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">qn_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ltensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.14)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.14)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/gs.html#eigh_direct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#renormalizer.mps.gs.eigh_direct" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="renormalizer.mps.gs.eigh_iterative">
<span class="sig-prename descclassname"><span class="pre">renormalizer.mps.gs.</span></span><span class="sig-name descname"><span class="pre">eigh_iterative</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mps.html#renormalizer.mps.Mps" title="renormalizer.mps.mps.Mps"><span class="pre">Mps</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">qn_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ltensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.14)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.14)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cguess</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/gs.html#eigh_iterative"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#renormalizer.mps.gs.eigh_iterative" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="renormalizer.mps.gs.func_sum">
<span class="sig-prename descclassname"><span class="pre">renormalizer.mps.gs.</span></span><span class="sig-name descname"><span class="pre">func_sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">funcs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/gs.html#func_sum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#renormalizer.mps.gs.func_sum" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="renormalizer.mps.gs.get_ham_direct">
<span class="sig-prename descclassname"><span class="pre">renormalizer.mps.gs.</span></span><span class="sig-name descname"><span class="pre">get_ham_direct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mps.html#renormalizer.mps.Mps" title="renormalizer.mps.mps.Mps"><span class="pre">Mps</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">qn_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ltensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.14)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.14)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/gs.html#get_ham_direct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#renormalizer.mps.gs.get_ham_direct" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="renormalizer.mps.gs.get_ham_iterative">
<span class="sig-prename descclassname"><span class="pre">renormalizer.mps.gs.</span></span><span class="sig-name descname"><span class="pre">get_ham_iterative</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mps.html#renormalizer.mps.Mps" title="renormalizer.mps.mps.Mps"><span class="pre">Mps</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">qn_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ltensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.14)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.14)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/gs.html#get_ham_iterative"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#renormalizer.mps.gs.get_ham_iterative" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="renormalizer.mps.gs.optimize_mps">
<span class="sig-prename descclassname"><span class="pre">renormalizer.mps.gs.</span></span><span class="sig-name descname"><span class="pre">optimize_mps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mps.html#renormalizer.mps.Mps" title="renormalizer.mps.mps.Mps"><span class="pre">Mps</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.14)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="mps.html#renormalizer.mps.Mpo" title="renormalizer.mps.mpo.Mpo"><span class="pre">Mpo</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">StackedMpo</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.14)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mps.html#renormalizer.mps.Mps" title="renormalizer.mps.mps.Mps"><span class="pre">Mps</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/renormalizer/mps/gs.html#optimize_mps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#renormalizer.mps.gs.optimize_mps" title="Permalink to this definition">#</a></dt>
<dd><p>DMRG ground state algorithm and state-averaged excited states algorithm</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mps</strong> (<a class="reference internal" href="mps.html#renormalizer.mps.Mps" title="renormalizer.mps.Mps"><em>renormalizer.mps.Mps</em></a>) – initial guess of mps. The MPS is overwritten during the optimization.</p></li>
<li><p><strong>mpo</strong> (<em>Union</em><em>[</em><a class="reference internal" href="mps.html#renormalizer.mps.Mpo" title="renormalizer.mps.Mpo"><em>renormalizer.mps.Mpo</em></a><em>, </em><em>renormalizer.mps.StackedMpo</em><em>]</em>) – mpo of Hamiltonian</p></li>
<li><p><strong>omega</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – target the eigenpair near omega with special variational function
:math:(hat{H}-omega)^2. Default is <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref any docutils literal notranslate"><span class="pre">None</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul>
<li><p><strong>energy</strong> (<em>list</em>) – list of energy of each marco sweep.
<span class="math notranslate nohighlight">\([e_0, e_0, \cdots, e_0]\)</span> if <code class="docutils literal notranslate"><span class="pre">nroots=1</span></code>.
<span class="math notranslate nohighlight">\([[e_0, \cdots, e_n], \dots, [e_0, \cdots, e_n]]\)</span> if <code class="docutils literal notranslate"><span class="pre">nroots=n</span></code>.</p></li>
<li><p><strong>mps</strong> (<em>renormalizer.mps.Mps</em>) –</p>
<dl class="simple">
<dt>optimized ground state MPS.</dt><dd><p>Note it’s not the same with the overwritten input MPS.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="configs.html#renormalizer.utils.configs.OptimizeConfig" title="renormalizer.utils.configs.OptimizeConfig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">renormalizer.utils.configs.OptimizeConfig</span></code></a></dt><dd><p>The optimization configuration.</p>
</dd>
</dl>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When On-the-fly swapping algorithm is used, the site ordering of the returned
MPS is changed and the original MPO will not correspond to it and should be
updated with returned mps.model.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="renormalizer.mps.gs.sign_fix">
<span class="sig-prename descclassname"><span class="pre">renormalizer.mps.gs.</span></span><span class="sig-name descname"><span class="pre">sign_fix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/gs.html#sign_fix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#renormalizer.mps.gs.sign_fix" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="renormalizer.mps.gs.single_sweep">
<span class="sig-prename descclassname"><span class="pre">renormalizer.mps.gs.</span></span><span class="sig-name descname"><span class="pre">single_sweep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mps.html#renormalizer.mps.Mps" title="renormalizer.mps.mps.Mps"><span class="pre">Mps</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.14)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="mps.html#renormalizer.mps.Mpo" title="renormalizer.mps.mpo.Mpo"><span class="pre">Mpo</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">StackedMpo</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">environ</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Environ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">percent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_opt_e_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/gs.html#single_sweep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#renormalizer.mps.gs.single_sweep" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="tamm-dancoff-approximation-for-excited-state">
<h2>Tamm-Dancoff approximation for excited state<a class="headerlink" href="#tamm-dancoff-approximation-for-excited-state" title="Permalink to this heading">#</a></h2>
<blockquote>
<div><span class="target" id="module-renormalizer.mps.tda"></span><dl class="py class">
<dt class="sig sig-object py" id="renormalizer.mps.tda.TDA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">renormalizer.mps.tda.</span></span><span class="sig-name descname"><span class="pre">TDA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hmpo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/tda.html#TDA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#renormalizer.mps.tda.TDA" title="Permalink to this definition">#</a></dt>
<dd><p>Tamm–Dancoff approximation (or called CIS) to calculate the excited
states based on MPS. TDA use the first order tangent space to do excitation.
The implementation is similar to J. Chem. Phys. 140, 024108 (2014).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>renormalizer.model.model</em>) – Model of the system</p></li>
<li><p><strong>hmpo</strong> (<a class="reference internal" href="mps.html#renormalizer.mps.Mpo" title="renormalizer.mps.Mpo"><em>renormalizer.mps.Mpo</em></a>) – mpo of Hamiltonian</p></li>
<li><p><strong>mps</strong> (<a class="reference internal" href="mps.html#renormalizer.mps.Mps" title="renormalizer.mps.Mps"><em>renormalizer.mps.Mps</em></a>) – ground state mps (will be overwritten)</p></li>
<li><p><strong>nroots</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>optional</em>) – number of roots to be calculated. Default is <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p></li>
<li><p><strong>algo</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – iterative diagonalization solver. Default is <code class="docutils literal notranslate"><span class="pre">&quot;primme&quot;</span></code> if <code class="docutils literal notranslate"><span class="pre">primme</span></code> is installed.
Valid options are <code class="docutils literal notranslate"><span class="pre">davidson</span></code> and <code class="docutils literal notranslate"><span class="pre">primme</span></code>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Quantum number is not used, thus the conservation is not guaranteed.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="renormalizer.mps.tda.TDA.analysis_1ordm">
<span class="sig-name descname"><span class="pre">analysis_1ordm</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/tda.html#TDA.analysis_1ordm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#renormalizer.mps.tda.TDA.analysis_1ordm" title="Permalink to this definition">#</a></dt>
<dd><p>calculate one-orbital reduced density matrix of each tda root</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="renormalizer.mps.tda.TDA.analysis_dominant_config">
<span class="sig-name descname"><span class="pre">analysis_dominant_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tda_m_trunc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_compressed_mps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/tda.html#TDA.analysis_dominant_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#renormalizer.mps.tda.TDA.analysis_dominant_config" title="Permalink to this definition">#</a></dt>
<dd><dl class="simple">
<dt>analyze the dominant configuration of each tda root.</dt><dd><p>The algorithm is to compress the tda wavefunction to a rank-1 Hartree
state and get the ci coefficient of the largest configuration.
Then, the configuration is subtracted from the tda wavefunction and
redo the first step to get the second largest configuration. The
two steps continue until the thresh is achieved.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>thresh</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – the threshold to stop the analysis procedure of each root.
<span class="math notranslate nohighlight">\(\sum_i |c_i|^2 &gt; thresh\)</span>. Default is 0.8.</p></li>
<li><p><strong>alias</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>, </em><em>optional</em>) – The alias of each site. For example, <code class="docutils literal notranslate"><span class="pre">alias={0:&quot;v_0&quot;,</span> <span class="pre">1:&quot;v_2&quot;,</span>
<span class="pre">2:&quot;v_1&quot;}</span></code>. Default is <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref any docutils literal notranslate"><span class="pre">None</span></code></a>.</p></li>
<li><p><strong>tda_m_trunc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>optional</em>) – the <code class="docutils literal notranslate"><span class="pre">m</span></code> to compress a tda wavefunction. Default is 20.</p></li>
<li><p><strong>return_compressed_mps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, return the tda excited state as a single compressed
mps. Default is <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.14)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>configs</strong> (<em>dict</em>) – The dominant configration of each root.
<code class="docutils literal notranslate"><span class="pre">configs</span> <span class="pre">=</span> <span class="pre">{0:[(config0,</span> <span class="pre">config_name0,</span> <span class="pre">ci_coeff0),(config1,</span>
<span class="pre">config_name1,</span> <span class="pre">ci_coeff1),...],</span> <span class="pre">1:...}</span></code></p></li>
<li><p><strong>compressed_mps</strong> (<em>List[renormalizer.mps.Mps]</em>) – see the description in <code class="docutils literal notranslate"><span class="pre">return_compressed_mps</span></code>.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The compressed_mps is an approximation of the tda wavefunction with
<code class="docutils literal notranslate"><span class="pre">m=tda_m_trunc</span></code>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="renormalizer.mps.tda.TDA.dump_wfn">
<span class="sig-name descname"><span class="pre">dump_wfn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/tda.html#TDA.dump_wfn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#renormalizer.mps.tda.TDA.dump_wfn" title="Permalink to this definition">#</a></dt>
<dd><p>Dump wavefunction for restart and analysis</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>mps_l_cano.npz: left-canonical form of initial mps
mps_r_cano.npz: right-canonical form of the initial mps
tangent_u: the tangent space u of the mixed-canonical mps
tda_coeff_{iroot}.npz: the tda_coeff of the ith root.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="renormalizer.mps.tda.TDA.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">restart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_psi0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/tda.html#TDA.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#renormalizer.mps.tda.TDA.kernel" title="Permalink to this definition">#</a></dt>
<dd><p>calculate the roots</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>restart</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – if restart from the former converged root. Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.
If <code class="docutils literal notranslate"><span class="pre">restart</span> <span class="pre">=</span> <span class="pre">True</span></code>, <code class="docutils literal notranslate"><span class="pre">include_psi0</span></code> must be the same as the
former calculation.</p></li>
<li><p><strong>include_psi0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – <dl class="simple">
<dt>if the basis of Hamiltonian includes the ground state</dt><dd><p><span class="math notranslate nohighlight">\(\Psi_0\)</span>. Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>e</strong> – the energy of the states, if <code class="docutils literal notranslate"><span class="pre">include_psi0</span> <span class="pre">=</span> <span class="pre">True</span></code>, the first
element is the ground state energy, otherwise, it is the energy of
the first excited state.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="renormalizer.mps.tda.TDA.load_wfn">
<span class="sig-name descname"><span class="pre">load_wfn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/tda.html#TDA.load_wfn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#renormalizer.mps.tda.TDA.load_wfn" title="Permalink to this definition">#</a></dt>
<dd><p>Load tda wavefunction</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="renormalizer.mps.tda.merge">
<span class="sig-prename descclassname"><span class="pre">renormalizer.mps.tda.</span></span><span class="sig-name descname"><span class="pre">merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mpsl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpsr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/tda.html#merge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#renormalizer.mps.tda.merge" title="Permalink to this definition">#</a></dt>
<dd><p>merge two mps (mpsl, mpsr) at dix
idx belongs mpsr, the other attributes are the same aas mpsl</p>
</dd></dl>

</div></blockquote>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="spectrum.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">spectra: absorption/emission spectrum at zero/finite temperature</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="mps.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Low Level Data Structure and Algorithms</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Shuaigroup
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Static Eigenstate Method</a><ul>
<li><a class="reference internal" href="#module-renormalizer.mps.gs">Ground state and state-averaged method</a><ul>
<li><a class="reference internal" href="#renormalizer.mps.gs.DmrgFCISolver"><code class="docutils literal notranslate"><span class="pre">DmrgFCISolver</span></code></a><ul>
<li><a class="reference internal" href="#renormalizer.mps.gs.DmrgFCISolver.kernel"><code class="docutils literal notranslate"><span class="pre">DmrgFCISolver.kernel()</span></code></a></li>
<li><a class="reference internal" href="#renormalizer.mps.gs.DmrgFCISolver.make_rdm1"><code class="docutils literal notranslate"><span class="pre">DmrgFCISolver.make_rdm1()</span></code></a></li>
<li><a class="reference internal" href="#renormalizer.mps.gs.DmrgFCISolver.make_rdm12"><code class="docutils literal notranslate"><span class="pre">DmrgFCISolver.make_rdm12()</span></code></a></li>
<li><a class="reference internal" href="#renormalizer.mps.gs.DmrgFCISolver.make_rdm2"><code class="docutils literal notranslate"><span class="pre">DmrgFCISolver.make_rdm2()</span></code></a></li>
<li><a class="reference internal" href="#renormalizer.mps.gs.DmrgFCISolver.spin_square"><code class="docutils literal notranslate"><span class="pre">DmrgFCISolver.spin_square()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#renormalizer.mps.gs.construct_mps_mpo"><code class="docutils literal notranslate"><span class="pre">construct_mps_mpo()</span></code></a></li>
<li><a class="reference internal" href="#renormalizer.mps.gs.eigh_direct"><code class="docutils literal notranslate"><span class="pre">eigh_direct()</span></code></a></li>
<li><a class="reference internal" href="#renormalizer.mps.gs.eigh_iterative"><code class="docutils literal notranslate"><span class="pre">eigh_iterative()</span></code></a></li>
<li><a class="reference internal" href="#renormalizer.mps.gs.func_sum"><code class="docutils literal notranslate"><span class="pre">func_sum()</span></code></a></li>
<li><a class="reference internal" href="#renormalizer.mps.gs.get_ham_direct"><code class="docutils literal notranslate"><span class="pre">get_ham_direct()</span></code></a></li>
<li><a class="reference internal" href="#renormalizer.mps.gs.get_ham_iterative"><code class="docutils literal notranslate"><span class="pre">get_ham_iterative()</span></code></a></li>
<li><a class="reference internal" href="#renormalizer.mps.gs.optimize_mps"><code class="docutils literal notranslate"><span class="pre">optimize_mps()</span></code></a></li>
<li><a class="reference internal" href="#renormalizer.mps.gs.sign_fix"><code class="docutils literal notranslate"><span class="pre">sign_fix()</span></code></a></li>
<li><a class="reference internal" href="#renormalizer.mps.gs.single_sweep"><code class="docutils literal notranslate"><span class="pre">single_sweep()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#tamm-dancoff-approximation-for-excited-state">Tamm-Dancoff approximation for excited state</a><ul>
<li><a class="reference internal" href="#renormalizer.mps.tda.TDA"><code class="docutils literal notranslate"><span class="pre">TDA</span></code></a><ul>
<li><a class="reference internal" href="#renormalizer.mps.tda.TDA.analysis_1ordm"><code class="docutils literal notranslate"><span class="pre">TDA.analysis_1ordm()</span></code></a></li>
<li><a class="reference internal" href="#renormalizer.mps.tda.TDA.analysis_dominant_config"><code class="docutils literal notranslate"><span class="pre">TDA.analysis_dominant_config()</span></code></a></li>
<li><a class="reference internal" href="#renormalizer.mps.tda.TDA.dump_wfn"><code class="docutils literal notranslate"><span class="pre">TDA.dump_wfn()</span></code></a></li>
<li><a class="reference internal" href="#renormalizer.mps.tda.TDA.kernel"><code class="docutils literal notranslate"><span class="pre">TDA.kernel()</span></code></a></li>
<li><a class="reference internal" href="#renormalizer.mps.tda.TDA.load_wfn"><code class="docutils literal notranslate"><span class="pre">TDA.load_wfn()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#renormalizer.mps.tda.merge"><code class="docutils literal notranslate"><span class="pre">merge()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/furo.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>