

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>7. Static Eigenstate Method &mdash; Renormalizer 0.1.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="8. spectra: absorption/emission spectrum at zero/finite temperature" href="spectrum.html" />
    <link rel="prev" title="6. Low Level Data Structure and Algorithms" href="mps.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Renormalizer
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">1. An overview of Renormalizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">2. Installation guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="develop.html">3. How to develop Renormalizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">4. Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="model.html">5. Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="mps.html">6. Low Level Data Structure and Algorithms</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">7. Static Eigenstate Method</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-renormalizer.mps.gs">7.1. Ground state and state-averaged method</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tamm-dancoff-approximation-for-excited-state">7.2. Tamm-Dancoff approximation for excited state</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="spectrum.html">8. spectra: absorption/emission spectrum at zero/finite temperature</a></li>
<li class="toctree-l1"><a class="reference internal" href="ct.html">9. Charge Transport</a></li>
<li class="toctree-l1"><a class="reference internal" href="cv.html">10. Frequency domain DMRG</a></li>
<li class="toctree-l1"><a class="reference internal" href="configs.html">11. Calculation Configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="lib.html">12. lib</a></li>
<li class="toctree-l1"><a class="reference internal" href="sbm.html">13. Spin-Boson Model</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Renormalizer</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li><span class="section-number">7. </span>Static Eigenstate Method</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/static.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="static-eigenstate-method">
<h1><span class="section-number">7. </span>Static Eigenstate Method<a class="headerlink" href="#static-eigenstate-method" title="Permalink to this heading">¶</a></h1>
<div class="section" id="module-renormalizer.mps.gs">
<span id="ground-state-and-state-averaged-method"></span><h2><span class="section-number">7.1. </span>Ground state and state-averaged method<a class="headerlink" href="#module-renormalizer.mps.gs" title="Permalink to this heading">¶</a></h2>
<p>This module contains functions to optimize mps for a single ground state or
several lowest excited states with state-averaged algorithm.</p>
<dl class="py function">
<dt class="sig sig-object py" id="renormalizer.mps.gs.construct_mps_mpo">
<span class="sig-prename descclassname"><span class="pre">renormalizer.mps.gs.</span></span><span class="sig-name descname"><span class="pre">construct_mps_mpo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nexciton</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset=&lt;renormalizer.utils.quantity.Quantity</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/gs.html#construct_mps_mpo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#renormalizer.mps.gs.construct_mps_mpo" title="Permalink to this definition">¶</a></dt>
<dd><p>MPO/MPS structure 2
e1,ph11,ph12,..e2,ph21,ph22,…en,phn1,phn2…</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="renormalizer.mps.gs.eigh_direct">
<span class="sig-prename descclassname"><span class="pre">renormalizer.mps.gs.</span></span><span class="sig-name descname"><span class="pre">eigh_direct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mps.html#renormalizer.mps.Mps" title="renormalizer.mps.mps.Mps"><span class="pre">Mps</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">qnmat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ltensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.10)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/gs.html#eigh_direct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#renormalizer.mps.gs.eigh_direct" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="renormalizer.mps.gs.eigh_iterative">
<span class="sig-prename descclassname"><span class="pre">renormalizer.mps.gs.</span></span><span class="sig-name descname"><span class="pre">eigh_iterative</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mps.html#renormalizer.mps.Mps" title="renormalizer.mps.mps.Mps"><span class="pre">Mps</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">qnmat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ltensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.10)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cguess</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.10)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/gs.html#eigh_iterative"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#renormalizer.mps.gs.eigh_iterative" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="renormalizer.mps.gs.optimize_mps">
<span class="sig-prename descclassname"><span class="pre">renormalizer.mps.gs.</span></span><span class="sig-name descname"><span class="pre">optimize_mps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mps.html#renormalizer.mps.Mps" title="renormalizer.mps.mps.Mps"><span class="pre">Mps</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mps.html#renormalizer.mps.Mpo" title="renormalizer.mps.mpo.Mpo"><span class="pre">Mpo</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.10)"><span class="pre">List</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="mps.html#renormalizer.mps.Mps" title="renormalizer.mps.mps.Mps"><span class="pre">Mps</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/renormalizer/mps/gs.html#optimize_mps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#renormalizer.mps.gs.optimize_mps" title="Permalink to this definition">¶</a></dt>
<dd><p>DMRG ground state algorithm and state-averaged excited states algorithm</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mps</strong> (<a class="reference internal" href="mps.html#renormalizer.mps.Mps" title="renormalizer.mps.Mps"><em>renormalizer.mps.Mps</em></a>) – initial guess of mps. The MPS is overwritten during the optimization.</p></li>
<li><p><strong>mpo</strong> (<a class="reference internal" href="mps.html#renormalizer.mps.Mpo" title="renormalizer.mps.Mpo"><em>renormalizer.mps.Mpo</em></a>) – mpo of Hamiltonian</p></li>
<li><p><strong>omega</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – target the eigenpair near omega with special variational function
:math:(hat{H}-omega)^2. Default is <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref any docutils literal notranslate"><span class="pre">None</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul>
<li><p><strong>energy</strong> (<em>list</em>) – list of energy of each marco sweep.
<span class="math notranslate nohighlight">\([e_0, e_0, \cdots, e_0]\)</span> if <code class="docutils literal notranslate"><span class="pre">nroots=1</span></code>.
<span class="math notranslate nohighlight">\([[e_0, \cdots, e_n], \dots, [e_0, \cdots, e_n]]\)</span> if <code class="docutils literal notranslate"><span class="pre">nroots=n</span></code>.</p></li>
<li><p><strong>mps</strong> (<em>renormalizer.mps.Mps</em>) –</p>
<dl class="simple">
<dt>optimized ground state MPS.</dt><dd><p>Note it’s not the same with the overwritten input MPS.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="configs.html#renormalizer.utils.configs.OptimizeConfig" title="renormalizer.utils.configs.OptimizeConfig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">renormalizer.utils.configs.OptimizeConfig</span></code></a></dt><dd><p>The optimization configuration.</p>
</dd>
</dl>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When On-the-fly swapping algorithm is used, the site ordering of the returned
MPS is changed and the original MPO will not correspond to it and should be
updated with returned mps.model.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="renormalizer.mps.gs.single_sweep">
<span class="sig-prename descclassname"><span class="pre">renormalizer.mps.gs.</span></span><span class="sig-name descname"><span class="pre">single_sweep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mps.html#renormalizer.mps.Mps" title="renormalizer.mps.mps.Mps"><span class="pre">Mps</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mps.html#renormalizer.mps.Mpo" title="renormalizer.mps.mpo.Mpo"><span class="pre">Mpo</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">environ</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Environ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">mmax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">percent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_opt_e_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/gs.html#single_sweep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#renormalizer.mps.gs.single_sweep" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="tamm-dancoff-approximation-for-excited-state">
<h2><span class="section-number">7.2. </span>Tamm-Dancoff approximation for excited state<a class="headerlink" href="#tamm-dancoff-approximation-for-excited-state" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><span class="target" id="module-renormalizer.mps.tda"></span><dl class="py class">
<dt class="sig sig-object py" id="renormalizer.mps.tda.TDA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">renormalizer.mps.tda.</span></span><span class="sig-name descname"><span class="pre">TDA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hmpo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/tda.html#TDA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#renormalizer.mps.tda.TDA" title="Permalink to this definition">¶</a></dt>
<dd><p>Tamm–Dancoff approximation (or called CIS) to calculate the excited
states based on MPS. TDA use the first order tangent space to do excitation.
The implementation is similar to J. Chem. Phys. 140, 024108 (2014).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>renormalizer.model.model</em>) – Model of the system</p></li>
<li><p><strong>hmpo</strong> (<a class="reference internal" href="mps.html#renormalizer.mps.Mpo" title="renormalizer.mps.Mpo"><em>renormalizer.mps.Mpo</em></a>) – mpo of Hamiltonian</p></li>
<li><p><strong>mps</strong> (<a class="reference internal" href="mps.html#renormalizer.mps.Mps" title="renormalizer.mps.Mps"><em>renormalizer.mps.Mps</em></a>) – ground state mps (will be overwritten)</p></li>
<li><p><strong>nroots</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – number of roots to be calculated. Default is <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p></li>
<li><p><strong>algo</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – iterative diagonalization solver. Default is <code class="docutils literal notranslate"><span class="pre">&quot;primme&quot;</span></code> if <code class="docutils literal notranslate"><span class="pre">primme</span></code> is installed.
Valid options are <code class="docutils literal notranslate"><span class="pre">davidson</span></code> and <code class="docutils literal notranslate"><span class="pre">primme</span></code>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Quantum number is not used, thus the conservation is not guaranteed.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="renormalizer.mps.tda.TDA.analysis_1ordm">
<span class="sig-name descname"><span class="pre">analysis_1ordm</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/tda.html#TDA.analysis_1ordm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#renormalizer.mps.tda.TDA.analysis_1ordm" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate one-orbital reduced density matrix of each tda root</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="renormalizer.mps.tda.TDA.analysis_dominant_config">
<span class="sig-name descname"><span class="pre">analysis_dominant_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tda_m_trunc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_compressed_mps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/tda.html#TDA.analysis_dominant_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#renormalizer.mps.tda.TDA.analysis_dominant_config" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>analyze the dominant configuration of each tda root.</dt><dd><p>The algorithm is to compress the tda wavefunction to a rank-1 Hartree
state and get the ci coefficient of the largest configuration.
Then, the configuration is subtracted from the tda wavefunction and
redo the first step to get the second largest configuration. The
two steps continue until the thresh is achieved.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>thresh</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – the threshold to stop the analysis procedure of each root.
<span class="math notranslate nohighlight">\(\sum_i |c_i|^2 &gt; thresh\)</span>. Default is 0.8.</p></li>
<li><p><strong>alias</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><em>dict</em></a><em>, </em><em>optional</em>) – The alias of each site. For example, <code class="docutils literal notranslate"><span class="pre">alias={0:&quot;v_0&quot;,</span> <span class="pre">1:&quot;v_2&quot;,</span>
<span class="pre">2:&quot;v_1&quot;}</span></code>. Default is <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref any docutils literal notranslate"><span class="pre">None</span></code></a>.</p></li>
<li><p><strong>tda_m_trunc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – the <code class="docutils literal notranslate"><span class="pre">m</span></code> to compress a tda wavefunction. Default is 20.</p></li>
<li><p><strong>return_compressed_mps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, return the tda excited state as a single compressed
mps. Default is <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.10)"><code class="xref any docutils literal notranslate"><span class="pre">False</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>configs</strong> (<em>dict</em>) – The dominant configration of each root.
<code class="docutils literal notranslate"><span class="pre">configs</span> <span class="pre">=</span> <span class="pre">{0:[(config0,</span> <span class="pre">config_name0,</span> <span class="pre">ci_coeff0),(config1,</span>
<span class="pre">config_name1,</span> <span class="pre">ci_coeff1),...],</span> <span class="pre">1:...}</span></code></p></li>
<li><p><strong>compressed_mps</strong> (<em>List[renormalizer.mps.Mps]</em>) – see the description in <code class="docutils literal notranslate"><span class="pre">return_compressed_mps</span></code>.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The compressed_mps is an approximation of the tda wavefunction with
<code class="docutils literal notranslate"><span class="pre">m=tda_m_trunc</span></code>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="renormalizer.mps.tda.TDA.dump_wfn">
<span class="sig-name descname"><span class="pre">dump_wfn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/tda.html#TDA.dump_wfn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#renormalizer.mps.tda.TDA.dump_wfn" title="Permalink to this definition">¶</a></dt>
<dd><p>Dump wavefunction for restart and analysis</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>mps_l_cano.npz: left-canonical form of initial mps
mps_r_cano.npz: right-canonical form of the initial mps
tangent_u: the tangent space u of the mixed-canonical mps
tda_coeff_{iroot}.npz: the tda_coeff of the ith root.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="renormalizer.mps.tda.TDA.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">restart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_psi0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/tda.html#TDA.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#renormalizer.mps.tda.TDA.kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate the roots</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>restart</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – if restart from the former converged root. Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.
If <code class="docutils literal notranslate"><span class="pre">restart</span> <span class="pre">=</span> <span class="pre">True</span></code>, <code class="docutils literal notranslate"><span class="pre">include_psi0</span></code> must be the same as the
former calculation.</p></li>
<li><p><strong>include_psi0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – <dl class="simple">
<dt>if the basis of Hamiltonian includes the ground state</dt><dd><p><span class="math notranslate nohighlight">\(\Psi_0\)</span>. Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>e</strong> – the energy of the states, if <code class="docutils literal notranslate"><span class="pre">include_psi0</span> <span class="pre">=</span> <span class="pre">True</span></code>, the first
element is the ground state energy, otherwise, it is the energy of
the first excited state.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="renormalizer.mps.tda.TDA.load_wfn">
<span class="sig-name descname"><span class="pre">load_wfn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/tda.html#TDA.load_wfn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#renormalizer.mps.tda.TDA.load_wfn" title="Permalink to this definition">¶</a></dt>
<dd><p>Load tda wavefunction</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="renormalizer.mps.tda.merge">
<span class="sig-prename descclassname"><span class="pre">renormalizer.mps.tda.</span></span><span class="sig-name descname"><span class="pre">merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mpsl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpsr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/tda.html#merge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#renormalizer.mps.tda.merge" title="Permalink to this definition">¶</a></dt>
<dd><p>merge two mps (mpsl, mpsr) at dix
idx belongs mpsr, the other attributes are the same aas mpsl</p>
</dd></dl>

</div></blockquote>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="spectrum.html" class="btn btn-neutral float-right" title="8. spectra: absorption/emission spectrum at zero/finite temperature" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="mps.html" class="btn btn-neutral float-left" title="6. Low Level Data Structure and Algorithms" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2019, Shuaigroup.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>