

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>2. Installation guide &mdash; Renormalizer 0.1.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="3. How to develop Renormalizer" href="develop.html" />
    <link rel="prev" title="1. An overview of Renormalizer" href="overview.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Renormalizer
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">1. An overview of Renormalizer</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">2. Installation guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#quick-installation">2.1. Quick installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#install-from-scratch">2.2. Install from scratch</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#python-environment">2.2.1. Python environment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#why-you-need-anaconda-when-you-already-have-python">2.2.1.1. Why you need Anaconda when you already have Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#install-anaconda">2.2.1.2. Install Anaconda</a></li>
<li class="toctree-l4"><a class="reference internal" href="#create-an-environment">2.2.1.3. Create an environment</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#download-renormalizer-and-run-tests">2.2.2. Download Renormalizer and run tests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#download-renormalizer">2.2.2.1. Download Renormalizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="#install-dependencies">2.2.2.2. Install dependencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="#run-tests">2.2.2.3. Run tests</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#gpu-support">2.3. GPU-support</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#overview">2.3.1. Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#install-cuda">2.3.2. Install CUDA</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#optional-install-nvtop">2.3.2.1. (Optional) Install nvtop</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#install-cupy">2.3.3. Install cupy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#verify-cupy">2.3.3.1. Verify cupy</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id1">2.3.4. Run tests</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="develop.html">3. How to develop Renormalizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">4. Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="model.html">5. Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="mps.html">6. Low Level Data Structure and Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="static.html">7. Static Eigenstate Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="spectrum.html">8. spectra: absorption/emission spectrum at zero/finite temperature</a></li>
<li class="toctree-l1"><a class="reference internal" href="ct.html">9. Charge Transport</a></li>
<li class="toctree-l1"><a class="reference internal" href="cv.html">10. Frequency domain DMRG</a></li>
<li class="toctree-l1"><a class="reference internal" href="configs.html">11. Calculation Configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="lib.html">12. lib</a></li>
<li class="toctree-l1"><a class="reference internal" href="sbm.html">13. Spin-Boson Model</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Renormalizer</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li><span class="section-number">2. </span>Installation guide</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/install.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="installation-guide">
<h1><span class="section-number">2. </span>Installation guide<a class="headerlink" href="#installation-guide" title="Permalink to this heading">¶</a></h1>
<div class="section" id="quick-installation">
<h2><span class="section-number">2.1. </span>Quick installation<a class="headerlink" href="#quick-installation" title="Permalink to this heading">¶</a></h2>
<p>If you are familiar with Python and not concerned with the development of the package, install <code class="docutils literal notranslate"><span class="pre">renormalizer</span></code> via <code class="docutils literal notranslate"><span class="pre">pip</span></code></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install renormalizer
</pre></div>
</div>
<p>Optionally, install <code class="docutils literal notranslate"><span class="pre">primme</span></code> for high-performance static DMRG</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">primme</span>
</pre></div>
</div>
<p>If any error occurs during the installation, see the <a class="reference external" href="https://github.com/primme/primme">official document</a> for details.</p>
<p>Optionally, install <code class="docutils literal notranslate"><span class="pre">CuPy</span></code> for GPU backend. Please see the <a class="reference external" href="https://docs.cupy.dev/en/stable/install.html">official document</a> for details.
<code class="docutils literal notranslate"><span class="pre">renormalizer</span></code> auto-detects whether <code class="docutils literal notranslate"><span class="pre">CuPy</span></code> is installed during its import.
If <code class="docutils literal notranslate"><span class="pre">CuPy</span></code> is installed, then <code class="docutils literal notranslate"><span class="pre">renormalzier</span></code> will automatically use GPU to accelerate tensor contractions.</p>
<p>If you are not familiar with python or wish to setup a local development environment, continue reading.</p>
</div>
<div class="section" id="install-from-scratch">
<h2><span class="section-number">2.2. </span>Install from scratch<a class="headerlink" href="#install-from-scratch" title="Permalink to this heading">¶</a></h2>
<p>This is a step by step guide on how to prepare an environment for Renormalizer from scratch.
Although “install” is in the name of this section, we actually won’t “install” Renormalizer as a standalone package that can be imported anywhere. What we achieve in this section is to put source files of Renormalizer into your computer and prepare a Python environment that can run it.</p>
<p>Renormalizer runs on both CPU and GPU. It is recommended to install CPU-only version first, then GPU support (if possible).</p>
<p>The CPU-only version runs on Windows/MacOSX/Linux, whereas the GPU support is only tested on Linux.</p>
<p>As operations on MacOSX are similar to those on Linux, from now on we’ll only talk about Windows and Linux.</p>
<div class="section" id="python-environment">
<h3><span class="section-number">2.2.1. </span>Python environment<a class="headerlink" href="#python-environment" title="Permalink to this heading">¶</a></h3>
<p>There are various ways to prepare a Python environment for Renormalizer. Here we recommend using Anaconda (both 2 or 3 are ok, we recommend Anaconda 3) as a package and environment manager.</p>
<div class="section" id="why-you-need-anaconda-when-you-already-have-python">
<h4><span class="section-number">2.2.1.1. </span>Why you need Anaconda when you already have Python<a class="headerlink" href="#why-you-need-anaconda-when-you-already-have-python" title="Permalink to this heading">¶</a></h4>
<p>Anaconda manages <em>environments</em>. If you use Python frequently enough, one day you’ll face problems similar to this: project A runs on Python 3.5 but not Python 3.6, project B runs only on Python 3.6, how could I develop project A and project B on the same machine? Anaconda can help you solve these problems with ease.</p>
<p>Another common issue about Python is that its environment screws up quite frequently. You may accidentally install multiple versions of the same package or delete some critical packages and then you’ll get a strange error importing the package you want. Find out what went wrong can take hours and you just wish you can reinstall Python. Anaconda can help you reinstall Python clean and easy with 2-3 commands.</p>
<p>Anaconda has lots of other cool features, you’ll learn more while you’re using it.</p>
<p>If you find the installation of Anaconda annoying and you already have Python 3.7, in theory, you can skip the installation and use your Python directly. But if something went wrong and your Python couldn’t work anymore, you’ll probably feel that using Anaconda is a good idea.</p>
</div>
<div class="section" id="install-anaconda">
<h4><span class="section-number">2.2.1.2. </span>Install Anaconda<a class="headerlink" href="#install-anaconda" title="Permalink to this heading">¶</a></h4>
<p>You can skip this step if you already have access to Anaconda (which means you can use <code class="docutils literal notranslate"><span class="pre">conda</span></code> command in your command line). For Linux users, don’t worry if you don’t have the root privilege – installing Anaconda doesn’t require root.</p>
<blockquote>
<div><p>A reminder to <em>dirac</em> (The cluster in Shuai group) users: both Anaconda2 and Anaconda3 have been installed on the cluster. Try <code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">load</span> <span class="pre">anaconda/3</span></code>.</p>
</div></blockquote>
<p>For users in Tsinghua, Anaconda can be downloaded from <em><a class="reference external" href="https://tuna.tsinghua.edu.cn/">tuna</a></em>. You can simply think of <em>tuna</em> as a cloud disk inside Tsinghua.</p>
<p>There are lots of links in the <a class="reference external" href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/">download page</a>. You need to choose a correct version for your operating system and preferably a relatively newer version.</p>
<p>If access to <em>tuna</em> is not feasible, please download Anaconda <a class="reference external" href="https://www.anaconda.com/">here</a>.</p>
<p>For Linux users, use <code class="docutils literal notranslate"><span class="pre">bash</span></code> to run the installation script.</p>
<p>After the installation, test the installation using <code class="docutils literal notranslate"><span class="pre">conda</span></code> command. Anaconda has a graphic user interface for MacOSX and Windows, however we recommend using a command-line interface. If your command line can’t find <code class="docutils literal notranslate"><span class="pre">conda</span></code>, please try to locate where <code class="docutils literal notranslate"><span class="pre">conda</span></code> is installed and add <code class="docutils literal notranslate"><span class="pre">conda</span></code> (<code class="docutils literal notranslate"><span class="pre">conda.exe</span></code> for Windows) to your system environment <code class="docutils literal notranslate"><span class="pre">PATH</span></code>, or you can use <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">prompt</span></code> if it is installed.</p>
</div>
<div class="section" id="create-an-environment">
<h4><span class="section-number">2.2.1.3. </span>Create an environment<a class="headerlink" href="#create-an-environment" title="Permalink to this heading">¶</a></h4>
<p>If Anaconda has been installed you should now be able to use Python in the command line. This Python is shipped with Anaconda and we recommend <strong>not</strong> using it for any particular Python project. The best practice is to create an environment for every project so that they don’t mess up.</p>
<p>Users inside Tsinghua may use <em>tuna</em> to speed up installation. See <a class="reference external" href="https://mirrors.tuna.tsinghua.edu.cn/help/anaconda/">this page</a> for the official document. In short, use the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">config</span> <span class="o">--</span><span class="n">add</span> <span class="n">channels</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">mirrors</span><span class="o">.</span><span class="n">tuna</span><span class="o">.</span><span class="n">tsinghua</span><span class="o">.</span><span class="n">edu</span><span class="o">.</span><span class="n">cn</span><span class="o">/</span><span class="n">anaconda</span><span class="o">/</span><span class="n">pkgs</span><span class="o">/</span><span class="n">free</span><span class="o">/</span>    
<span class="n">conda</span> <span class="n">config</span> <span class="o">--</span><span class="n">add</span> <span class="n">channels</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">mirrors</span><span class="o">.</span><span class="n">tuna</span><span class="o">.</span><span class="n">tsinghua</span><span class="o">.</span><span class="n">edu</span><span class="o">.</span><span class="n">cn</span><span class="o">/</span><span class="n">anaconda</span><span class="o">/</span><span class="n">pkgs</span><span class="o">/</span><span class="n">main</span><span class="o">/</span>    
<span class="n">conda</span> <span class="n">config</span> <span class="o">--</span><span class="nb">set</span> <span class="n">show_channel_urls</span> <span class="n">yes</span>    
</pre></div>
</div>
<p>to let Anaconda know it can download resources from <em>tuna</em>.</p>
<p>In this step, we’re going to create a Python environment for Renormalizer using Anaconda. Two things must be taken into consideration while creating a Python environment:</p>
<ul>
<li><p>Python version. <strong>Python version higher than Python 3.5 is required for Renormalizer</strong>. We recommend using Python 3.7 or higher.</p>
<blockquote>
<div><p>Renormalizer uses <em>type annotation</em> like <code class="docutils literal notranslate"><span class="pre">a:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">3</span></code> or <code class="docutils literal notranslate"><span class="pre">b:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">3.0</span></code> which helps to make code clearer but requires Python 3.6 or higher. For more info about <em>type annotation</em>, see the <a class="reference external" href="https://docs.python.org/3/library/typing.html">typing module</a> or <a class="reference external" href="https://www.python.org/dev/peps/pep-0484/">PEP484</a>.</p>
</div></blockquote>
</li>
<li><p>Name of the environment. Choose anything you like. <strong>In this guide we are going to use <code class="docutils literal notranslate"><span class="pre">Reno</span></code> as it is the nickname of the project</strong>.</p></li>
</ul>
<p>With Python version and name of the environment determined, create the environment using the following command (Note the environment name <code class="docutils literal notranslate"><span class="pre">Reno</span></code>)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">create</span> <span class="o">-</span><span class="n">n</span> <span class="n">Reno</span> <span class="n">python</span><span class="o">=</span><span class="mf">3.7</span> <span class="o">-</span><span class="n">y</span>
</pre></div>
</div>
<p>This might take 1 to 20 minutes depending on network conditions. After the process finished, you’ll have a Python environment named <code class="docutils literal notranslate"><span class="pre">Reno</span></code> managed by Anaconda.</p>
<p>To use this environment:</p>
<ul class="simple">
<li><p>For Linux users, use <code class="docutils literal notranslate"><span class="pre">source</span> <span class="pre">activate</span> <span class="pre">Reno</span></code> or <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">activate</span> <span class="pre">Reno</span></code></p></li>
<li><p>For Windows users, use <code class="docutils literal notranslate"><span class="pre">activate</span> <span class="pre">Reno</span></code></p></li>
</ul>
<p>In most cases the name of the environment will appear in the command line interface.</p>
<p>To verify the environment is activated, use <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">--version</span></code> to ensure that you’re using Python 3.7. You can also use <code class="docutils literal notranslate"><span class="pre">which</span> <span class="pre">python</span></code> (for Linux) or <code class="docutils literal notranslate"><span class="pre">where</span> <span class="pre">python</span></code> (for Windows) to see where the Python program locates. It should locate under a directory like <code class="docutils literal notranslate"><span class="pre">~/anaconda/envs/Reno/bin/</span></code> (Note the environment name <code class="docutils literal notranslate"><span class="pre">Reno</span></code> in the path).</p>
</div>
</div>
<div class="section" id="download-renormalizer-and-run-tests">
<h3><span class="section-number">2.2.2. </span>Download Renormalizer and run tests<a class="headerlink" href="#download-renormalizer-and-run-tests" title="Permalink to this heading">¶</a></h3>
<div class="section" id="download-renormalizer">
<h4><span class="section-number">2.2.2.1. </span>Download Renormalizer<a class="headerlink" href="#download-renormalizer" title="Permalink to this heading">¶</a></h4>
<ul>
<li><p>If you wish to develop Renormalizer, <code class="docutils literal notranslate"><span class="pre">Git</span></code> is a necessary tool. Learning <code class="docutils literal notranslate"><span class="pre">Git</span></code> is beyond the scope of this guide. We assume you already know some basic knowledge of <code class="docutils literal notranslate"><span class="pre">Git</span></code> and how to download Renormalizer using <code class="docutils literal notranslate"><span class="pre">Git</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">jjren</span><span class="o">/</span><span class="n">Renormalizer</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
</li>
<li><p>If you simply wish to try out Renormalizer, you can <a class="reference external" href="https://github.com/shuaigroup/Renormalizer/archive/master.zip">download</a> the source files directly.</p></li>
</ul>
</div>
<div class="section" id="install-dependencies">
<h4><span class="section-number">2.2.2.2. </span>Install dependencies<a class="headerlink" href="#install-dependencies" title="Permalink to this heading">¶</a></h4>
<p>Renormalizer relies on lots of other Python packages to run. We recommend using <code class="docutils literal notranslate"><span class="pre">pip</span></code> to install these packages. For users in Tsinghua, <em>tuna</em> makes life easier by providing the fastest download speed. According to the <a class="reference external" href="https://mirrors.tuna.tsinghua.edu.cn/help/pypi/">official document</a>, run the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">config</span> <span class="nb">set</span> <span class="k">global</span><span class="o">.</span><span class="n">index</span><span class="o">-</span><span class="n">url</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">pypi</span><span class="o">.</span><span class="n">tuna</span><span class="o">.</span><span class="n">tsinghua</span><span class="o">.</span><span class="n">edu</span><span class="o">.</span><span class="n">cn</span><span class="o">/</span><span class="n">simple</span>
</pre></div>
</div>
<p>to let <code class="docutils literal notranslate"><span class="pre">pip</span></code> download from <em>tuna</em>.</p>
<p>Now, to install the required packages:</p>
<ol>
<li><p>Enter the <code class="docutils literal notranslate"><span class="pre">Renormalizer</span></code> directory. You should be able to find a <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> file.</p></li>
<li><p>Double check again you’re using the correct Python environment</p></li>
<li><p>install dependencies with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">r</span> <span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
</li>
<li><p>(Optional) For high-performance ground state DMRG, <code class="docutils literal notranslate"><span class="pre">primme</span></code> should also be installed with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">primme</span><span class="o">==</span><span class="mf">3.2</span><span class="o">.*</span>
</pre></div>
</div>
<blockquote>
<div><p>Sometimes an error will occur during the installation of <code class="docutils literal notranslate"><span class="pre">primme</span></code>, especially on Windows platform. Please refer to the <a class="reference external" href="https://github.com/primme/primme">primme installation guide</a> for more details.</p>
</div></blockquote>
</li>
</ol>
</div>
<div class="section" id="run-tests">
<h4><span class="section-number">2.2.2.3. </span>Run tests<a class="headerlink" href="#run-tests" title="Permalink to this heading">¶</a></h4>
<p>To run tests, use the <code class="docutils literal notranslate"><span class="pre">pytest</span></code> command installed in the previous step in the Renormalizer source code directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pytest</span>
</pre></div>
</div>
<p>This tool will collect tests in Renormalizer and run them. The tests should run for 10-20 minutes.</p>
<blockquote>
<div><p>Although the source code of the tests can help you understand how the code works, it is not recommended to start your scientific project by modifying the tests because they are designed for testing and not scientific research. You can firstly read the (test) code and grasp some basic idea on what happens, then write programs using modules in <code class="docutils literal notranslate"><span class="pre">renormalizer.mps</span></code> rather than <code class="docutils literal notranslate"><span class="pre">renormalizer.spectra</span></code> or <code class="docutils literal notranslate"><span class="pre">renormalizer.transport</span></code>. Only use the tests directly when you completely understand each line of the test code.</p>
</div></blockquote>
<p>Finally, to make Python find Renormalizer, add Renormalizer directory to <code class="docutils literal notranslate"><span class="pre">PYTHONPATH</span></code>. For example, if
Renormalizer is installed in <code class="docutils literal notranslate"><span class="pre">/opt</span></code>, you can add the following path to
your <code class="docutils literal notranslate"><span class="pre">~/.bashrc</span></code> and then <code class="docutils literal notranslate"><span class="pre">source</span> <span class="pre">~/.bashrc</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>export PYTHONPATH=/opt/Renormalizer:$PYTHONPATH
</pre></div>
</div>
<p>To ensure the setting is successful, start a Python shell, and try:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">renormalizer</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="gpu-support">
<h2><span class="section-number">2.3. </span>GPU-support<a class="headerlink" href="#gpu-support" title="Permalink to this heading">¶</a></h2>
<div class="section" id="overview">
<h3><span class="section-number">2.3.1. </span>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">¶</a></h3>
<p>If you already have a CPU-only version working, the only step for GPU support is to install a new package called <a class="reference external" href="https://github.com/cupy/cupy"><code class="docutils literal notranslate"><span class="pre">CuPy</span></code></a>, which is a <code class="docutils literal notranslate"><span class="pre">NumPy</span></code> analog for GPU, and then Renormalizer can run with GPU backend.</p>
<p>If the CPU-only version has not been installed, please follow <a class="reference external" href="#Install-from-scrach">the steps</a> first.</p>
<p>A few things to notice before we start:</p>
<ul class="simple">
<li><p>GPU support is only tested under Linux. If you’re using Windows or MacOS and something unexpected happens, there could be lots of reasons and fixing the issue might take a while (maybe forever). So we highly recommend a Linux environment for GPU environment.</p></li>
<li><p>Make sure you have a decent NVIDIA GPU. The GPU driver, <a class="reference external" href="https://developer.nvidia.com/cuda-toolkit">CUDA</a>, doesn’t support very old GPU, integrated GPU or AMD GPU. You can find the list of CUDA-supported GPUs <a class="reference external" href="https://www.geforce.com/hardware/technology/cuda/supported-gpus">here</a>.</p></li>
</ul>
</div>
<div class="section" id="install-cuda">
<h3><span class="section-number">2.3.2. </span>Install CUDA<a class="headerlink" href="#install-cuda" title="Permalink to this heading">¶</a></h3>
<p>Install CUDA following the <a class="reference external" href="https://docs.nvidia.com/cuda/cuda-quick-start-guide/index.html">official document</a>. All CUDA version later than 8.0 (included) should be OK. Use Google well if any troubles are met. <strong>Be sure to verify the installation</strong>.</p>
<blockquote>
<div><p>The computer cluster <em>dirac</em> of Shuai group has two nodes called <code class="docutils literal notranslate"><span class="pre">c91</span></code> and <code class="docutils literal notranslate"><span class="pre">c92</span></code> each equipped with 4 <a class="reference external" href="https://www.techpowerup.com/gpu-specs/tesla-v100-pcie-32-gb.c3184">V100</a> GPUs. CUDA has already been installed on the node and you can use the environment by <code class="docutils literal notranslate"><span class="pre">module</span></code> command.</p>
</div></blockquote>
<div class="section" id="optional-install-nvtop">
<h4><span class="section-number">2.3.2.1. </span>(Optional) Install nvtop<a class="headerlink" href="#optional-install-nvtop" title="Permalink to this heading">¶</a></h4>
<p><a class="reference external" href="https://github.com/Syllo/nvtop"><code class="docutils literal notranslate"><span class="pre">nvtop</span></code></a> is a handy tool to monitor GPU usage. The installation procedure can be quite formidable if you are not familiar with how to use Git and install software from source files. Feel free to skip this step.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">nvtop</span></code> has been installed on <code class="docutils literal notranslate"><span class="pre">c91</span></code> and <code class="docutils literal notranslate"><span class="pre">c92</span></code> on <em>dirac</em>.</p>
</div></blockquote>
</div>
</div>
<div class="section" id="install-cupy">
<h3><span class="section-number">2.3.3. </span>Install cupy<a class="headerlink" href="#install-cupy" title="Permalink to this heading">¶</a></h3>
<p>After CUDA is installed and verified, you can install <code class="docutils literal notranslate"><span class="pre">CuPy</span></code> using the following commands. Remember when you install something you have to make sure you’re in the correct Python environment!</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(For CUDA 8.0)
$ pip install cupy-cuda80

(For CUDA 9.0)
$ pip install cupy-cuda90

(For CUDA 9.1)
$ pip install cupy-cuda91

(For CUDA 9.2)
$ pip install cupy-cuda92

(For CUDA 10.0)
$ pip install cupy-cuda100
</pre></div>
</div>
<blockquote>
<div><p>Sometimes you have to install a package without network connection (such as in <code class="docutils literal notranslate"><span class="pre">c91</span></code>). In such cases, you can download the required wheel file under network connection, copy the files to the node and then install with <code class="docutils literal notranslate"><span class="pre">pip</span></code>.</p>
</div></blockquote>
<div class="section" id="verify-cupy">
<h4><span class="section-number">2.3.3.1. </span>Verify cupy<a class="headerlink" href="#verify-cupy" title="Permalink to this heading">¶</a></h4>
<p>Sometimes <code class="docutils literal notranslate"><span class="pre">CuPy</span></code> can be successfully installed but actually not working. Here is a sample script to test if it’s working or not:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cupy</span> <span class="k">as</span> <span class="nn">cp</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
<p>If any error happens, usually it’s because the CUDA environment is not correct. Please verify your CUDA installation again and make sure you haven’t installed multiple versions of cupy. As a last resort, you can delete the whole Python environment and start over:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">env</span> <span class="n">remove</span> <span class="o">--</span><span class="n">name</span> <span class="n">Reno</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id1">
<h3><span class="section-number">2.3.4. </span>Run tests<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h3>
<p>Just as what we do in the CPU-only version, use</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pytest</span>
</pre></div>
</div>
<p>and wait.</p>
<p>During the test, you can monitor the GPU usage by <code class="docutils literal notranslate"><span class="pre">nvidia-smi</span></code> or <code class="docutils literal notranslate"><span class="pre">nvtop</span></code>. Moderate GPU usage is expected. If GPU usage is zero, probably Renormalizer still runs on CPU. Make sure the python interpreter running the tests can import <code class="docutils literal notranslate"><span class="pre">cupy</span></code>.</p>
<p>Note: <strong>Renormalizer is still under heavy development. API changes come without any prior deprecation.</strong></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="develop.html" class="btn btn-neutral float-right" title="3. How to develop Renormalizer" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="overview.html" class="btn btn-neutral float-left" title="1. An overview of Renormalizer" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2019, Shuaigroup.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>